@tailwind base;
@tailwind components;
@tailwind utilities;

/* MOBILE APP CONFIGURATION */
:root {
  /* Define Safe Area variables for the Notch and Home Bar */
  --safe-top: env(safe-area-inset-top);
  --safe-bottom: env(safe-area-inset-bottom);
  --safe-left: env(safe-area-inset-left);
  --safe-right: env(safe-area-inset-right);
}

html, body {
  /* Prevent "Rubber Banding" (Pull-to-refresh feel) */
  overscroll-behavior-y: none;
  /* Prevent text selection (optional, makes it feel more app-like) */
  -webkit-tap-highlight-color: transparent;
}

/* === GLOBAL THEME VARIABLES === */
:root {
  /* --- Brand Identity --- */
  --color-primary: #2563eb; 
  --color-primary-hover: #1d4ed8; 
  --color-on-primary: #ffffff;    

  --color-secondary: #4b5563;
  --color-secondary-hover: #374151;
  --color-on-secondary: #ffffff;

  --color-accent: #0d9488; 
  --color-accent-hover: #0f766e;
  --color-on-accent: #ffffff;

  /* --- Interface Theme --- */
  --color-background: #111827; 
  --color-surface: #1f2937;    
  
  /* --- Typography --- */
  --color-text-primary: #f9fafb; 
  --color-text-secondary: #d1d5db; 
  
  --color-border: var(--color-secondary); 

  /* === MATERIAL DESIGN 3 - DYNAMIC TOKENS === */
  /* These automatically adapt based on the colors above using color-mix */

  /* Containers: Soft backgrounds for active states (e.g. Sidebar Pills) */
  /* Mix Primary/Secondary with Surface to create a subtle tint */
  --color-primary-container: color-mix(in srgb, var(--color-primary) 25%, var(--color-surface));
  --color-on-primary-container: var(--color-text-primary);
  --color-secondary-container: color-mix(in srgb, var(--color-secondary) 25%, var(--color-surface));
  --color-on-secondary-container: var(--color-text-primary);

  /* Surfaces: Depth hierarchy without borders */
  --color-surface-container-low: var(--color-background);
  --color-surface-container: var(--color-surface);
  /* High: Lighter than surface (for Cards) */
  --color-surface-container-high: color-mix(in srgb, var(--color-surface) 90%, #ffffff); 
  /* Highest: Even lighter (for Modals/Dialogs) */
  --color-surface-container-highest: color-mix(in srgb, var(--color-surface) 80%, #ffffff);

  /* Outlines */
  --color-outline: var(--color-text-secondary);
  --color-outline-variant: var(--color-border);

  /* Shapes (Radii) */
  --radius-sm: 0.5rem;   /* 8px */
  --radius-md: 0.75rem;  /* 12px */
  --radius-lg: 1rem;     /* 16px */
  --radius-xl: 1.75rem;  /* 28px - M3 Standard for Cards */
  --radius-2xl: 2.5rem;  /* 40px */
  --radius-3xl: 3rem;    /* 48px */
  --radius-full: 9999px; /* Stadium/Pill */

  /* === STATUS & ALERTS === */
  --color-error: #ef4444;
  --color-warning: #f59e0b;
  --color-success: #10b981;
  
  --color-error-container: color-mix(in srgb, var(--color-error) 15%, var(--color-surface));
  --color-warning-container: color-mix(in srgb, var(--color-warning) 15%, var(--color-surface));
  --color-success-container: color-mix(in srgb, var(--color-success) 15%, var(--color-surface));
}

/* === UTILITY CLASSES === */
@layer utilities {
  .bg-primary { background-color: var(--color-primary); }
  .bg-primary-hover:hover { background-color: var(--color-primary-hover); }
  .text-primary { color: var(--color-primary); }
  
  .bg-secondary { background-color: var(--color-secondary); }
  .text-secondary { color: var(--color-text-secondary); }
  
  .bg-accent { background-color: var(--color-accent); }
  .text-accent { color: var(--color-accent); }
  
  .bg-surface { background-color: var(--color-surface); }
  .bg-background { background-color: var(--color-background); }
  
  .text-text-primary { color: var(--color-text-primary); }
  .text-text-secondary { color: var(--color-text-secondary); }
  
  /* M3 Utilities */
  .bg-primary-container { background-color: var(--color-primary-container); }
  .text-on-primary-container { color: var(--color-on-primary-container); }
  .bg-surface-container-high { background-color: var(--color-surface-container-high); }

  /* Status Utilities */
  .text-error { color: var(--color-error); }
  .bg-error-container { background-color: var(--color-error-container); }
  .text-warning { color: var(--color-warning); }
  .bg-warning-container { background-color: var(--color-warning-container); }
  .text-success { color: var(--color-success); }
  .bg-success-container { background-color: var(--color-success-container); }
  
  .border-border { border-color: var(--color-border); }
  
  .text-on-primary { color: var(--color-on-primary); }
  .text-on-secondary { color: var(--color-on-secondary); }
  .text-on-accent { color: var(--color-on-accent); }
}

/* === PRINT STYLES === */
@media screen {
  .print-only { display: none; }
}

@media print {
  /* 1. Hide everything using visibility (allows children to be visible) */
  body * {
    visibility: hidden;
  }

  /* 2. Make the print container and all its children visible */
  .print-only * {
    visibility: visible !important;
    /* NOTE: We DO NOT force 'display: block' here, as it breaks component-level flex/grid layouts. */
  }

  /* 3. Position and reveal the print container itself */
  .print-only {
    visibility: visible !important; /* Make the container visible */
    display: block !important;      /* Ensure the container itself is a block */
    position: fixed; /* Fixed works better to escape modal scroll contexts */
    left: 0;
    top: 0;
    width: 100vw;
    height: 100vh;
    background: white;
    z-index: 99999; /* Sit on top of everything */
    margin: 0;
    padding: 0;
    overflow: visible;
  }
  
  /* 4. Hide scrollbars and margins on body */
  body {
    margin: 0;
    padding: 0;
    overflow: hidden; 
  }
}

/* === COMPONENT OVERRIDES === */

/* On Hold Event Pattern */
.on-hold-event {
  background-color: #404040;
  background-image: repeating-linear-gradient(
    45deg,
    rgba(255, 255, 255, 0.05),
    rgba(255, 255, 255, 0.05) 10px,
    transparent 10px,
    transparent 20px
  );
  color: #a0a0a0;
  border: 1px dashed var(--color-border);
}

/* React-Select Dark Theme Customizations */
.react-select-container .react-select__control {
  background-color: var(--color-background);
  border-color: var(--color-border);
}
.react-select-container .react-select__input-container {
  color: var(--color-text-primary);
}
.react-select-container .react-select__multi-value {
  background-color: var(--color-primary);
}
.react-select-container .react-select__multi-value__label {
  color: var(--color-on-primary);
}
.react-select-container .react-select__multi-value__remove:hover {
  background-color: var(--color-primary-hover);
  color: var(--color-on-primary);
}
.react-select-container .react-select__menu {
  background-color: var(--color-surface);
}
.react-select-container .react-select__option--is-focused {
  background-color: var(--color-background);
}
.react-select-container .react-select__option--is-selected {
  background-color: var(--color-primary);
}

/* React-Grid-Layout Customizations */
.react-grid-item .react-resizable-handle::after {
  content: '';
  position: absolute;
  right: 3px; bottom: 3px; width: 20px; height: 20px;
  background: radial-gradient(circle at 100% 100%, transparent 4px, var(--color-secondary) 4px, var(--color-secondary) 6px, transparent 6px),
              radial-gradient(circle at 100% 100%, transparent 9px, var(--color-secondary) 9px, var(--color-secondary) 11px, transparent 11px);
  transform: rotate(180deg);
  opacity: 0.7;
}
.react-grid-item:hover .react-resizable-handle::after { opacity: 1; }

.layout .drag-handle {
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease-in-out;
}
.layout .react-resizable-handle { display: none; }

.layout.edit-mode .drag-handle {
    opacity: 0.5;
    pointer-events: all;
}
.layout.edit-mode .drag-handle:hover { opacity: 1; }
.layout.edit-mode .react-resizable-handle { display: block; }
.layout.edit-mode .react-grid-item {
    box-shadow: 0 0 0 2px var(--color-primary);
}

/* Email Settings Toggle */
.toggle-checkbox:checked {
    right: 0;
    border-color: var(--color-primary);
}
.toggle-checkbox:checked + .toggle-label {
    background-color: var(--color-primary);
}

/* === SUPERTOKENS LOGIN OVERRIDES === */
[data-supertokens~="container"] {
    background-color: var(--color-surface) !important;
    border: 1px solid var(--color-border) !important;
    font-family: inherit !important;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5) !important;
}
[data-supertokens~="headerTitle"],
[data-supertokens~="text"] {
    color: var(--color-text-primary) !important;
}
[data-supertokens~="label"] {
    color: var(--color-text-secondary) !important;
}
[data-supertokens~="link"],
[data-supertokens~="link"]:hover {
    color: var(--color-accent) !important;
}
[data-supertokens~="input"] {
    background-color: var(--color-background) !important;
    border-color: var(--color-border) !important;
    color: var(--color-text-primary) !important;
}
[data-supertokens~="input"]:focus {
    border-color: var(--color-primary) !important;
    box-shadow: 0 0 0 1px var(--color-primary) !important;
}
[data-supertokens~="button"] {
    background-color: var(--color-primary) !important;
    color: var(--color-on-primary) !important;
    border-radius: 0.5rem !important;
    text-transform: uppercase;
    font-weight: 700 !important;
    border: none !important;
}
[data-supertokens~="button"]:hover {
    background-color: var(--color-primary-hover) !important;
}
[data-supertokens~="headerSubtitle"] {
    display: none !important;
}
[data-supertokens~="headerTitle"] {
    visibility: hidden;
    position: relative;
}
[data-supertokens~="headerTitle"]::after {
    content: 'Welcome Back';
    visibility: visible;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    text-align: center;
    color: var(--color-text-primary);
}
[data-supertokens~="superTokensBranding"] {
    display: none !important;
}

/* 8. Force Page Background (Behind the modal) */
body {
    background-color: var(--color-background);
    color: var(--color-text-primary);
    min-height: 100vh;
}

/* Force React Mentions Portal to be on top of everything (Modals are usually z-50) */
body > div[style*="position: absolute"] {
    z-index: 100000 !important;
}

div[style*="z-index: 99999"] {
    z-index: 2147483647 !important;
}
/* Prevent iOS Auto-Zoom on inputs */

@media screen and (max-width: 768px) {
  input, select, textarea {
    font-size: 16px !important;
  }
}

/* === NATIVE MOBILE HARDENING (Notch & Home Bar) === */
@media (max-width: 1024px) {
  header {
    padding-top: calc(1rem + var(--safe-top)) !important;
  }
  
  aside.fixed {
    padding-top: calc(1.5rem + var(--safe-top)) !important;
    padding-bottom: calc(1.5rem + var(--safe-bottom)) !important;
    padding-left: calc(1.5rem + var(--safe-left)) !important;
  }

  main {
    padding-bottom: calc(2rem + var(--safe-bottom)) !important;
  }
}

/* === QR SCANNER LASER ANIMATION === */
@keyframes scanner-laser {
  0% { top: 0%; opacity: 0; }
  10% { opacity: 1; }
  90% { opacity: 1; }
  100% { top: 100%; opacity: 0; }
}
.scan-laser {
  position: absolute;
  height: 2px;
  width: 100%;
  background: var(--color-accent);
  box-shadow: 0 0 12px var(--color-accent), 0 0 4px var(--color-accent);
  animation: scanner-laser 2s linear infinite;
}

@media screen {
  .print-only { display: none; }
}
====
@media screen {
  .print-only { 
    position: absolute;
    width: 0;
    height: 0;
    overflow: hidden;
    padding: 0;
    margin: 0;
    visibility: hidden;
  }
}